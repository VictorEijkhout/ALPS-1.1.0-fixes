!===============================================
!  ALPS INPUT FILE: Quick Test Example
!  120 x 240 momentum resolution
!  6 v_ts spread (from test_kpar_fast_dist.in)
!  Scan over one decade in kparallel
!
!  Kristopher Klein, Daniel Verscharen
!  2023 FEB 17
!===============================================
! REQUIRED NAMELISTS
!===============================================
! SYSTEM AND PLASMA PARAMETERS
&system
!Perpendicular and Parallel Wavenumbers
!Normalized to reference inertial length
kperp=1.d-2
kpar=1.d-3
!Number of Plasma Species
nspec=2
!System Option (see README file)
option=0
!Number of Dispersion Solutions to find and follow
nroots=1
!Logical to:
    !T: use search for roots over a map 
    !   in complex frequency space
    !OR
    !F: use input guesses for solutions 
use_map=.false.
!Write or Supress output to screen:
writeOut=.true.
!Momentum Space Resolution of f0
nperp=120
npar=240
!Reference Alfven Velocity / c
vA=1.d-4
!Name of input array- 
!Located in 'distribution' folder
arrayName='test_kpar_fast'
!Maximum amplitude of Bessel function to determine nmax
Bessel_zero = 1.d-50
!Maximum number of intertions in secant method
numiter = 500
!Value of "zero" for secant method
D_threshold = 1.d-13
!Size of Bounding Region for secant method
D_prec = 1.d-5
!Size of Allowable gap between solutions
D_gap=1.D-5
!# points in principle value integral; see documentation
positions_principal=3
!# steps to integrate around resonance
n_resonance_interval=100
!Threshold for analytical principal-value integration
Tlim=0.01d0
!Max # of fitting iterations
maxsteps_fit=500
!Levenberg Marquart Parameters
lambda_initial_fit=1.d0
lambdafac_fit=10.d0
epsilon_fit=1.d-8
!T-> output fit parameters to ASCII in distribution/
fit_check=T
!T-> After map scan, determine minima and refine
determine_minima=T
scan_option=1 !1: consecutive scans, 2: double scan
n_scan=1 !number of wavevector scans
use_secant=T !T-> use secant method; F->rtsec method
/

!initial guess of complex frequency for first solution
!only used when use_map=.false.
!need to have # of name lists 
&guess_1
g_om=9.9d-4    !real frequency
g_gam=-5.5d-10 !imaginary frequency
/

!Range of complex frequencies for map_scan
!only used when use_map=.true.
&maps_1
loggridw=.false. !log or linear scan of real freq.
loggridg=.false. !log or linear scan of imag. freq.
omi     = 1.55d0 !minimum value of real freq.
omf     = 3.d0   !maximum value of real freq.
gami    = -3.125d-3  !minimum value of imag. freq.
gamf    = 3.125d-3   !maximum value of imag. freq.
ni      = 2  !# of steps in imag. freq.
nr      = 64 !# of steps in real freq. 
/

!Species parameters list; protons
&spec_1
nn=1.d0  !relative density; n_j/n_ref
qq=1.d0  !relative charge;  q_j/q_ref
mm=1.d0  !relative mass;    m_j/m_ref
ff=1     !# of fits to be used.
relat=F  !relativistic(T) or non-relativistic(F) species
log_fit=T!log(T) or linear(F) fit
use_bM=F !numerically integrate array(F) or use bimaxwellian(T)
/

!Initial Fit Values; species 1, function 1
&ffit_1_1 
fit_type_in=1 !kind of fit function; 1=biMaxwellian
fit_1=1.7959D-1 !suggested values for parameters 
fit_2=1.d0      !are generated by generate_distribution
fit_3=0.d0
fit_4=0.d0
fit_5=0.d0
perpcorr=1.D0 !renormalization factor; see generate_distribution
/

!BiMaxwellian parameters; for species 1
!only used if use_bM=T
&bM_spec_1
bM_nmaxs=500 !maximum number of resonaces to consider
bM_Bessel_zeros=1.d-50 !amplitude limit for Bessel Function
bM_betas=1.d0 !plasma beta for species 1
bM_alphas=1.d0 !Tperp/Tpar for species 1
bM_pdrifts=0.d0 !species 2 momentum drift, norm. to m_ref v_A,ref
/

!Species parameters list; electrons
&spec_2
nn=1.d0  !relative density; n_j/n_ref
qq=-1.d0  !relative charge;  q_j/q_ref
mm=0.000544662d0  !relative mass;    m_j/m_ref
ff=1     !# of fits to be used.
relat=F  !relativistic(T) or non-relativistic(F) species
log_fit=T!log(T) or linear(F) fit
use_bM=F !numerically integrate array(F) or use bimaxwellian(T)
/

!Initial Fit Values; for species 2, function 1
&ffit_2_1 
fit_type_in=1 !kind of fit function; 1=biMaxwellian
fit_1=1.4128D+4 !suggested values for parameters 
fit_2=1.836D+3  !are generated by generate_distribution
fit_3=0.d0
fit_4=0.d0
fit_5=0.d0
perpcorr=1.836D+3 !renormalization factor; see generate_distribution
/

!BiMaxwellian parameters for species 2
!only used if use_bM=T
&bM_spec_2
bM_nmaxs=500 !maximum number of resonaces to consider
bM_Bessel_zeros=1.d-50 !amplitude limit for Bessel Function
bM_betas=1.d0 !plasma beta for species 2
bM_alphas=1.d0 !Tperp/Tpar for species 2
bM_pdrifts=0.d0 !species 2 momentum drift, norm. to m_ref v_A,ref
/

!inputs for scanning parameter space for 1st scan
!see documentation for details
&scan_input_1
scan_type=4 !kpar scan
swi=0.001d0 !initial kpar value
swf=0.01d0  !final kpar value
swlog=.true. !log (T) or linear (F) steps
ns=32 !# of steps
nres=1 !# of substeps
heating=.false. !calculate heating rates
eigen=.false.   !calculate eigenfunctions
/


